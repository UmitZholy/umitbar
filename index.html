<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Umit bar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="favicon.png" type="image/png">
  <style>
    :root {
      --bg-color: #eef5ff;
      --text-color: #333;
      --card-bg: white;
      --btn-bg: #4a90e2;
      --btn-hover: #357ABD;
    }
    body.dark {
      --bg-color: #1e1e2f;
      --text-color: #f0f0f0;
      --card-bg: #2a2a3d;
      --btn-bg: #6a5acd;
      --btn-hover: #7b68ee;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      scroll-behavior: smooth;
      transition: background 0.5s, color 0.5s;
    }
    header {
      background-color: var(--btn-bg);
      color: white;
      padding: 40px 20px;
      text-align: center;
      position: relative;
      transition: background 0.5s;
    }
    header::after {
      content: '❤️';
      font-size: 24px;
      position: absolute;
      top: 20px;
      left: 20px;
    }
    #themeToggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: var(--card-bg);
      color: var(--text-color);
      border: none;
      border-radius: 20px;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.4s, color 0.4s;
    }
    h1 {
      margin-bottom: 10px;
      font-size: 32px;
    }
    p {
      font-size: 18px;
      margin: 0;
    }
    section {
      padding: 30px 20px;
      text-align: center;
    }
    h2 {
      color: var(--btn-bg);
      margin-top: 40px;
      font-size: 24px;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .quote, .support {
      background-color: var(--card-bg);
      margin: 20px auto;
      padding: 24px;
      border-radius: 20px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      font-size: 18px;
      line-height: 1.7;
      opacity: 0;
      animation: fadeInUp 0.8s ease forwards;
      transition: background 0.5s, color 0.5s;
    }
    .btn {
      display: inline-block;
      margin-top: 20px;
      padding: 14px 24px;
      background-color: var(--btn-bg);
      color: white;
      border: none;
      border-radius: 14px;
      text-decoration: none;
      font-size: 17px;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .btn:hover {
      background-color: var(--btn-hover);
      transform: translateY(-2px);
    }
    footer {
      text-align: center;
      padding: 20px;
      font-size: 14px;
      color: #777;
      margin-top: 50px;
    }
    textarea, input[type="text"] {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-size: 16px;
      background: var(--card-bg);
      color: var(--text-color);
      transition: background 0.5s, color 0.5s;
    }
    @media (max-width: 600px) {
      header { padding: 30px 15px; }
      h1 { font-size: 26px; }
      p { font-size: 16px; }
      h2 { font-size: 22px; }
      section { padding: 20px 10px; }
      .quote, .support { font-size: 16px; padding: 20px; max-width: 100%; }
      .btn { width: 100%; font-size: 16px; }
      textarea, input[type="text"] { font-size: 15px; }
    }
  </style>
</head>
<body>
  <header>
    <button id="themeToggle">Ночь</button>
    <h1>Umit bar</h1>
    <p>Сайт поддержки для подростков и всех, кому нужно тепло</p>
  </header>

  <section>
    <h2>Слова поддержки и тепла</h2>
    <div class="quote">Даже если сейчас трудно — ты обязательно справишься.</div>
    <div class="quote">Ты важен. Мир был бы другим без тебя.</div>
    <div class="quote">Твои чувства имеют значение.</div>
    <div class="quote">Никогда не поздно начать всё сначала.</div>
    <div class="quote">Каждый день — это новый шанс.</div>
    <div class="quote">Даже если ты не видишь свет — он есть.</div>
    <div class="quote">Ты не один. Мы рядом.</div>
    <div class="quote">Не бойся просить помощи. Ты не один.</div>

    <h2>Раздел "Umit bar"</h2>
    <div class="support">Привет! Просто останься здесь на минутку. Мы верим: даже через экран можно передать тепло. Ты не один.</div>

    <h2>Поделись своей историей</h2>
    <form class="support" onsubmit="event.preventDefault(); sendMessage('story');">
      <textarea id="storyInput" rows="6" placeholder="Напиши свою историю..."></textarea>
      <br>
      <button class="btn" type="submit">Отправить</button>
    </form>

    <h2>Добавь свою цитату</h2>
    <form class="support" onsubmit="event.preventDefault(); sendMessage('quote');">
      <input type="text" id="quoteInput" placeholder="Твоя цитата..." />
      <br><br>
      <button class="btn" type="submit">Добавить</button>
    </form>

    <h2>Советы и ресурсы</h2>
    <div class="support">
      - Делись своими переживаниями с теми, кому доверяешь.<br>
      - Иногда музыка, прогулка или добрый разговор — лучшее лекарство.<br>
      - Ты имеешь право на отдых и заботу о себе.<br>
      - Если очень тяжело — напиши нам. Ты не один.
    </div>

    <h2>Анонимные сообщения и истории</h2>
    <div id="approvedStories" class="support">Историй пока нет...</div>

    <h2>Уголок для музыки</h2>
    <div class="support">
      Иногда музыка — лучший друг. Несколько треков из моего плейлиста:<br><br>
      - <a href="https://open.spotify.com/track/2JjZQ0puhcx8wXdGN3GGli" target="_blank">Untouchable #1</a><br>
      - <a href="https://open.spotify.com/track/1GNo1hX3LJP7SeEaVn8kuY" target="_blank">Музе #2</a><br>
      - <a href="https://open.spotify.com/track/0TKJAeWKYUxDF7oFzWTJUA" target="_blank">T.G.G. #3</a><br><br>
      <a href="https://t.me/+tLpuSo2B5NFjZGJi" target="_blank">Мой Telegram-канал</a> | 
      <a href="https://open.spotify.com/playlist/1EkXDvSRWHiE1bMJa8ElR0" target="_blank">Плейлист в Spotify</a>
    </div>

  </section>

  <footer>
    Создано с душой | Umit bar © 2025
  </footer>

  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDxUlnP5z7r4UPtASJqoocTI6PBISlFcU0",
      authDomain: "umitbar-2a7c1.firebaseapp.com",
      projectId: "umitbar-2a7c1",
      storageBucket: "umitbar-2a7c1.appspot.com",
      messagingSenderId: "363649035498",
      appId: "1:363649035498:web:47da67b0c213e8fce9fb93",
      measurementId: "G-VFHDK0G5XZ"
    };
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    const db = firebase.firestore();

    function loadStories() {
      db.collection("submissions")
        .where("type", "==", "story")
        .where("approved", "==", true)
        .orderBy("createdAt", "desc")
        .get()
        .then(snapshot => {
          const container = document.getElementById("approvedStories");
          if (snapshot.empty) {
            container.textContent = "Историй пока нет.";
            return;
          }
          container.innerHTML = "";
          snapshot.forEach(doc => {
            const div = document.createElement("div");
            div.className = "quote";
            div.textContent = doc.data().message;
            container.appendChild(div);
          });
        })
        .catch(error => {
          console.error("Ошибка загрузки историй:", error);
        });
    }

    function sendMessage(type) {
      const story = document.getElementById("storyInput")?.value.trim();
      const quote = document.getElementById("quoteInput")?.value.trim();
      const botToken = "7842244275:AAFEFr7fwjSeCVnj1FTm9txIhZpkWWHfl_c";
      const chatId = "2071572237";

      let message = '';
      let dataToSave = {};

      if (type === 'story' && story) {
        message = `История: \n${story}`;
        dataToSave = { type: 'story', message: story, createdAt: new Date().toISOString() };
      } else if (type === 'quote' && quote) {
        message = `Цитата: \n${quote}`;
        dataToSave = { type: 'quote', message: quote, createdAt: new Date().toISOString() };
      } else {
        alert("Пожалуйста, заполните поле перед отправкой.");
        return;
      }

      fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`)
        .then(response => response.json())
        .then(data => {
          if (data.ok) {
            alert("Сообщение отправлено!");
            if (type === 'story') document.getElementById("storyInput").value = '';
            if (type === 'quote') document.getElementById("quoteInput").value = '';
          } else {
            alert("Ошибка при отправке в Telegram.");
          }
        })
        .catch(error => {
          console.error("Ошибка при отправке:", error);
          alert("Ошибка при отправке.");
        });

      db.collection("submissions").add(dataToSave)
        .then(() => {
          console.log("Успешно сохранено в Firestore.");
        })
        .catch(error => {
          console.error("Ошибка сохранения:", error);
        });
    }

    loadStories();

    // Переключение темы
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      themeToggle.textContent = document.body.classList.contains('dark') ? 'День' : 'Ночь';
    });
  </script>
</body>
</html>
